# Word文档切片工具

## 功能简介

这是一个用于批量处理Word文档(.doc/.docx)的工具，可以根据指定章节标题提取文档的部分内容，实现自动化的文档切片操作。主要用于从大型文档中提取特定章节内容，例如从项目文档中提取某些标准章节。

## 使用方法

1. 将需要处理的Word文档(.doc/.docx)放入`input_file`文件夹中
2. 运行`geter3.py`程序
3. 程序会自动处理所有文档，并将结果保存在对应的文件夹中

## 目录结构

- `input_file`: 存放待处理的Word文档
- `output_file`: 存放处理成功的文档，文件名会添加"_slice"后缀
- `unsupport_file`: 存放处理失败或不支持的文档
- `old_file`: 存放已处理过的原始文档
- `temp_file`: 临时文件目录，程序运行过程中使用

## 配置说明

在`geter3.py`主程序中可以配置以下参数：

```python
process_folder_by_delete(
    input_folder,             # 输入文件夹路径
    output_folder,            # 输出文件夹路径 
    unsupport_folder,         # 不支持文件夹路径
    "总论",                   # 第一个章节标题（切片起点）
    "建设方案",               # 第二个章节标题（切片终点）
    section1_offset=1,        # 第一个章节的偏移量（默认为1，表示与该章节同级的下一章）
    section2_offset=1,        # 第二个章节的偏移量（默认为1，表示与该章节同级的下一章）
    section1_level=1,         # 第一个章节的标题级别（默认为1，表示一级标题）
    section2_level=1          # 第二个章节的标题级别（默认为1，表示一级标题）
)
```

## 工作原理

1. 程序读取文档并识别其标题结构
2. 根据配置找到指定的起始章节（如"总论"）和结束章节（如"建设方案"）
3. 计算真正的切片位置（考虑偏移量和标题级别）
4. 删除文档中不需要的部分，只保留指定区间的内容
5. 保存处理结果并将文件移动到对应文件夹

## 文件处理规则

- 成功处理的文件：原文件移动到`old_file`目录，处理后的文件保存到`output_file`目录
- 无法处理的Word文件：原文件移动到`old_file`目录，临时文件移动到`unsupport_file`目录
- 非Word文件：直接移动到`unsupport_file`目录

## 依赖库

- win32com.client: 用于操作Word文档
- shutil: 用于文件操作
- tqdm: 用于显示进度条
- os: 用于文件路径操作
- logging: 用于日志记录

## 常见问题

1. **如果找不到指定章节**：文件会被移动到`unsupport_file`目录
2. **如果文件被占用**：程序会等待并重试，最终无法处理的文件会移动到`unsupport_file`目录
3. **如果Word无法启动**：请确保已安装Microsoft Office并能正常打开Word文档

## 日志记录

程序运行时会在控制台输出详细的处理日志，记录每个文件的处理状态和可能出现的错误。处理完成后会显示成功、失败、错误和不支持的文件数量统计。